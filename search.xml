<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Realsense D435i 深度相机 hsv 调参代码</title>
      <link href="/2023/09/20/%E6%B7%B1%E5%BA%A6%E7%9B%B8%E6%9C%BA%E8%B0%83hsv/"/>
      <url>/2023/09/20/%E6%B7%B1%E5%BA%A6%E7%9B%B8%E6%9C%BA%E8%B0%83hsv/</url>
      
        <content type="html"><![CDATA[<h2 id="Realsense-D435i-深度相机-hsv-调参代码"><a href="#Realsense-D435i-深度相机-hsv-调参代码" class="headerlink" title="Realsense D435i 深度相机 hsv 调参代码"></a>Realsense D435i 深度相机 hsv 调参代码</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">from</span> util_3 <span class="keyword">import</span> *</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nothing</span>(<span class="params">x</span>):</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cv2.namedWindow(&#x27;image&#x27;,cv2.WINDOW_AUTOSIZE)</span></span><br><span class="line">cv2.namedWindow(<span class="string">&#x27;image&#x27;</span>,cv2.WINDOW_FREERATIO)</span><br><span class="line">cv2.resizeWindow(<span class="string">&#x27;image&#x27;</span>, (<span class="number">640</span>, <span class="number">320</span>))</span><br><span class="line"><span class="comment"># blue = np.uint8([[[255,0,0]]])</span></span><br><span class="line"><span class="comment"># hsv_blue = cv2.cvtColor(blue,cv2.COLOR_BGR2HSV)</span></span><br><span class="line"><span class="comment"># print(hsv_blue)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">cv2.createTrackbar(<span class="string">&#x27;Hue min&#x27;</span>,<span class="string">&#x27;image&#x27;</span>,<span class="number">100</span>,<span class="number">255</span>,nothing)</span><br><span class="line">cv2.createTrackbar(<span class="string">&#x27;Hue max&#x27;</span>,<span class="string">&#x27;image&#x27;</span>,<span class="number">124</span>,<span class="number">255</span>,nothing)</span><br><span class="line">cv2.createTrackbar(<span class="string">&#x27;sat min&#x27;</span>,<span class="string">&#x27;image&#x27;</span>,<span class="number">43</span>,<span class="number">255</span>,nothing)</span><br><span class="line">cv2.createTrackbar(<span class="string">&#x27;sat max&#x27;</span>,<span class="string">&#x27;image&#x27;</span>,<span class="number">255</span>,<span class="number">255</span>,nothing)</span><br><span class="line">cv2.createTrackbar(<span class="string">&#x27;val min&#x27;</span>,<span class="string">&#x27;image&#x27;</span>,<span class="number">46</span>,<span class="number">255</span>,nothing)</span><br><span class="line">cv2.createTrackbar(<span class="string">&#x27;val max&#x27;</span>,<span class="string">&#x27;image&#x27;</span>,<span class="number">255</span>,<span class="number">255</span>,nothing)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 参数设置</span></span><br><span class="line">W, H = <span class="number">640</span>, <span class="number">480</span> <span class="comment"># 图像宽高</span></span><br><span class="line"><span class="comment"># W, H = 1280, 720 # 图像宽高</span></span><br><span class="line">FPS = <span class="number">30</span> <span class="comment"># 帧率</span></span><br><span class="line">MAX_LENGTH = <span class="number">1000</span> <span class="comment"># 区分正面和侧面轮廓所使用的空间长度</span></span><br><span class="line">RED = (<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>) <span class="comment"># 红色</span></span><br><span class="line">BLUE = (<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>) <span class="comment"># 蓝色</span></span><br><span class="line">GREEN = (<span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>) <span class="comment"># 绿色</span></span><br><span class="line"><span class="comment"># 设置hsv阈值</span></span><br><span class="line">lower_blue = np.array([<span class="number">240</span>, <span class="number">33</span>, <span class="number">40</span>])</span><br><span class="line"><span class="comment"># lower_blue = np.array([100, 43, 46])</span></span><br><span class="line">upper_blue = np.array([<span class="number">250</span>, <span class="number">255</span>, <span class="number">255</span>])</span><br><span class="line"><span class="comment"># upper_blue = np.array([124, 255, 255])</span></span><br><span class="line">lower_red = np.array([<span class="number">0</span>, <span class="number">33</span>, <span class="number">40</span>])</span><br><span class="line">upper_red = np.array([<span class="number">10</span>, <span class="number">255</span>, <span class="number">255</span>])</span><br><span class="line"><span class="comment"># 创建一个管道</span></span><br><span class="line">pipeline = rs.pipeline() </span><br><span class="line"><span class="comment"># 配置要流式传输的管道</span></span><br><span class="line">config = rs.config()</span><br><span class="line">config.enable_stream(rs.stream.color, W, H, rs.<span class="built_in">format</span>.bgr8, <span class="number">30</span>) <span class="comment"># 8位rgb图像</span></span><br><span class="line">config.enable_stream(rs.stream.depth, W, H, rs.<span class="built_in">format</span>.z16, <span class="number">30</span>) <span class="comment"># 16位深度图像</span></span><br><span class="line"><span class="comment"># 左右双目</span></span><br><span class="line">config.enable_stream(rs.stream.infrared, <span class="number">1</span>, W, H, rs.<span class="built_in">format</span>.y8, <span class="number">30</span>) <span class="comment"># 8位左红外图像</span></span><br><span class="line">config.enable_stream(rs.stream.infrared, <span class="number">2</span>, W, H, rs.<span class="built_in">format</span>.y8, <span class="number">30</span>) <span class="comment"># 8位右红外图像</span></span><br><span class="line">align = rs.align(rs.stream.color)</span><br><span class="line"><span class="comment"># 视野大，但有残缺</span></span><br><span class="line"><span class="comment"># align = rs.align(rs.stream.depth)</span></span><br><span class="line"><span class="comment"># 开始传输帧</span></span><br><span class="line">profile = pipeline.start(config)</span><br><span class="line"><span class="comment"># 更改rgb相机的曝光值</span></span><br><span class="line">color_sensor = profile.get_device().first_color_sensor()</span><br><span class="line">depth_sensor = profile.get_device().first_depth_sensor()</span><br><span class="line"><span class="comment"># 关闭自动曝光</span></span><br><span class="line">color_sensor.set_option(rs.option.enable_auto_exposure, <span class="number">0</span>)</span><br><span class="line">depth_sensor.set_option(rs.option.enable_auto_exposure, <span class="number">0</span>)</span><br><span class="line"><span class="comment"># 设置曝光值</span></span><br><span class="line">color_sensor.set_option(rs.option.exposure, <span class="number">25</span>)</span><br><span class="line">depth_sensor.set_option(rs.option.exposure, <span class="number">15000</span>)</span><br><span class="line"><span class="comment"># </span></span><br><span class="line">depth_sensor = profile.get_device().first_depth_sensor()</span><br><span class="line"><span class="comment"># </span></span><br><span class="line">depth_scale = depth_sensor.get_depth_scale()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 等待开启通道</span></span><br><span class="line">    frames = pipeline.wait_for_frames()</span><br><span class="line">    <span class="comment"># 将深度图和RGB图对齐</span></span><br><span class="line">    <span class="comment"># frames = align.process(frames)</span></span><br><span class="line">    <span class="comment"># 获得RGB图像</span></span><br><span class="line">    color_frame = frames.get_color_frame()</span><br><span class="line">    <span class="comment"># 未获得RGB图像</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> color_frame:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="comment"># 获得深度图像</span></span><br><span class="line">    <span class="comment"># depth_frame = frames.get_depth_frame()</span></span><br><span class="line">    <span class="comment"># 把图像像素转化为数组</span></span><br><span class="line">    color_image = np.asanyarray(color_frame.get_data())</span><br><span class="line">    <span class="comment"># depth_image = np.asanyarray(depth_frame.get_data())</span></span><br><span class="line">    <span class="comment"># 深度图像转化为伪彩色图像(alpha数值越大对比度色差越大)</span></span><br><span class="line">    <span class="comment"># depth_colormap = cv2.applyColorMap(cv2.convertScaleAbs(depth_image, alpha=0.21), cv2.COLORMAP_JET)</span></span><br><span class="line">    <span class="comment"># 转换到HSV (颜色空间转换) (色调H，饱和度S，亮度V)</span></span><br><span class="line">    <span class="comment"># hsv = cv2.cvtColor(color_image, cv2.COLOR_BGR2HSV)</span></span><br><span class="line"></span><br><span class="line">    img = color_image</span><br><span class="line">    hsv = cv2.cvtColor(img,cv2.COLOR_BGR2HSV)</span><br><span class="line">    h_min = cv2.getTrackbarPos(<span class="string">&#x27;Hue min&#x27;</span>,<span class="string">&#x27;image&#x27;</span>)</span><br><span class="line">    h_max = cv2.getTrackbarPos(<span class="string">&#x27;Hue max&#x27;</span>,<span class="string">&#x27;image&#x27;</span>)</span><br><span class="line">    s_min = cv2.getTrackbarPos(<span class="string">&#x27;sat min&#x27;</span>,<span class="string">&#x27;image&#x27;</span>)</span><br><span class="line">    s_max = cv2.getTrackbarPos(<span class="string">&#x27;sat max&#x27;</span>,<span class="string">&#x27;image&#x27;</span>)</span><br><span class="line">    v_min = cv2.getTrackbarPos(<span class="string">&#x27;val min&#x27;</span>,<span class="string">&#x27;image&#x27;</span>)</span><br><span class="line">    v_max = cv2.getTrackbarPos(<span class="string">&#x27;val max&#x27;</span>,<span class="string">&#x27;image&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">    lower = np.array([h_min,s_min,v_min])</span><br><span class="line">    upper = np.array([h_max,s_max,v_max])</span><br><span class="line">    mask = cv2.inRange(hsv,lower,upper)</span><br><span class="line">    res = cv2.bitwise_and(img,img,mask=mask)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># cv2.imshow(&#x27;img&#x27;,img)</span></span><br><span class="line">    cv2.imshow(<span class="string">&#x27;mask&#x27;</span>,mask)</span><br><span class="line">    <span class="comment"># cv2.imshow(&#x27;res&#x27;,res)</span></span><br><span class="line"> </span><br><span class="line">    k = cv2.waitKey(<span class="number">5</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> k == <span class="number">27</span>:</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"> </span><br><span class="line">cv2.destroyAllWindows()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2023/09/20/hello-world/"/>
      <url>/2023/09/20/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
